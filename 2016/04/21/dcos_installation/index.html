<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>DC/OS Deployment | Tranquility Garden</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="IntroductionEvery system operator always dreaming an infrastructure management tool like DCOS, makes job easier and more spare time.As you know, mesosphere.com released it as Open Source project on 20">
<meta property="og:type" content="article">
<meta property="og:title" content="DC/OS Deployment">
<meta property="og:url" content="http://blog.wuliwala.net/2016/04/21/dcos_installation/index.html">
<meta property="og:site_name" content="Tranquility Garden">
<meta property="og:description" content="IntroductionEvery system operator always dreaming an infrastructure management tool like DCOS, makes job easier and more spare time.As you know, mesosphere.com released it as Open Source project on 20">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/1.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/2.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/3.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/4.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/5.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/6.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/7.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/8.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/9.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/10.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/11.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/12.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/13.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/14.png">
<meta property="og:image" content="http://blog.wuliwala.net/images/2016/04/21/15.png">
<meta property="og:updated_time" content="2016-12-08T08:10:20.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DC/OS Deployment">
<meta name="twitter:description" content="IntroductionEvery system operator always dreaming an infrastructure management tool like DCOS, makes job easier and more spare time.As you know, mesosphere.com released it as Open Source project on 20">
<meta name="twitter:image" content="http://blog.wuliwala.net/images/2016/04/21/1.png">
  
    <link rel="alternate" href="http://blog.wuliwala.net/atom.xml" title="Tranquility Garden" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link href="/css/fonts.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-72217808-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tranquility Garden</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="http://blog.wuliwala.net">Home</a>
        
          <a class="main-nav-link" href="http://blog.wuliwala.net/archives">Archives</a>
        
          <a class="main-nav-link" href="http://blog.wuliwala.net/about">About</a>
        
          <a class="main-nav-link" href="https://github.com/arkii">GitHub</a>
        
          <a class="main-nav-link" href="https://hub.docker.com/u/arkii">DockerHub</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="http://blog.wuliwala.net/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.wuliwala.net"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-dcos_installation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/21/dcos_installation/" class="article-date">
  <time datetime="2016-04-21T10:42:00.000Z" itemprop="datePublished">2016-04-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloud/">cloud</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      DC/OS Deployment
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p><strong>Every system operator always dreaming an infrastructure management tool like <a href="https://dcos.io" target="_blank" rel="external">DCOS</a>, makes job easier and more spare time.</strong><br>As you know, mesosphere.com released it as <a href="https://mesosphere.com/blog/2016/04/19/open-source-dcos/" target="_blank" rel="external">Open Source project</a> on 2016/04/19.<br>So I tried it the first time.<br>This post reords my steps followed the official <a href="https://dcos.io/get-started" target="_blank" rel="external">guide</a>.<br>In this example, all my node is running CentOS7(with <code>yum -y update</code>), I used 6 nodes(1 deploy, 1 master, 4 compute), and if you want master node High-Availability, 8 nodes(1 deploy, 3 master, 4 compute) is recommended.<br>After deployment, the deploy node can be destroyed, so it can be a temporary vm.</p>
<h3 id="System-Requirements"><a href="#System-Requirements" class="headerlink" title="System Requirements"></a>System Requirements</h3><p>Please read <a href="https://dcos.io/docs/1.7/administration/installing/custom/system-requirements/" target="_blank" rel="external">system-requirements</a> carefully.<br>First time, I encountered an issue. It’s a shell script in the progress of deployment, to change the storage-driver to overlayfs.<br>I don’t know why if run with this <code>-H fd://</code>, docker daemon can not get started.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo mkdir -p /etc/systemd/system/docker.service.d &amp;&amp; sudo tee /etc/systemd/system/docker.service.d/override.conf &lt;&lt;- EOF</div><div class="line">[Service]</div><div class="line">ExecStart=</div><div class="line">ExecStart=/usr/bin/docker daemon --storage-driver=overlay -H fd://</div><div class="line">EOF</div></pre></td></tr></table></figure>
<ul>
<li>CentOS Linux release 7.2.1511 (Core)   </li>
<li>Linux 3.10.0-327.13.1.el7.x86_64  </li>
<li>docker 1.9.xx</li>
</ul>
<p>So I upgraded docker to v1.11.0</p>
<h3 id="Deployment-Progress"><a href="#Deployment-Progress" class="headerlink" title="Deployment Progress"></a>Deployment Progress</h3><h4 id="change-storage-driver-from-devicemapper-to-overlayfs"><a href="#change-storage-driver-from-devicemapper-to-overlayfs" class="headerlink" title="change storage-driver from devicemapper to overlayfs"></a>change storage-driver from devicemapper to overlayfs</h4><p><a href="https://docs.docker.com/engine/userguide/storagedriver/overlayfs-driver/" target="_blank" rel="external">docker official docs of storage driver</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">service docker stop</div><div class="line"></div><div class="line"><span class="comment"># remove  '-H fd://'</span></div><div class="line">sed -ie <span class="string">"/DOCKER_STORAGE_OPTIONS/s/=.*/='--storage-driver=overlay'/"</span> /etc/sysconfig/docker-storage</div><div class="line"></div><div class="line">service docker start</div><div class="line"></div><div class="line"><span class="comment"># check if storage-driver is overlay</span></div><div class="line">docker info</div></pre></td></tr></table></figure>
<h4 id="Download-amp-Start-the-DC-OS-installer"><a href="#Download-amp-Start-the-DC-OS-installer" class="headerlink" title="Download &amp; Start the DC/OS installer"></a>Download &amp; Start the DC/OS installer</h4><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">curl -O https://downloads.dcos.io/dcos/EarlyAccess/dcos_generate_config.sh</div><div class="line">bash dcos_generate_config.sh --web -v</div></pre></td></tr></table></figure>
<p>Launch the DC/OS web installer in your browser at: <code>http://&lt;bootstrap-node-public-ip&gt;:9000</code>.</p>
<p><strong>Follow this <a href="https://dcos.io/docs/1.7/administration/installing/custom/gui/" target="_blank" rel="external">GUI DC/OS Installation Guide</a>.</strong></p>
<h4 id="Uninstall-DC-OS"><a href="#Uninstall-DC-OS" class="headerlink" title="Uninstall DC/OS"></a>Uninstall DC/OS</h4><figure class="highlight mipsasm"><table><tr><td class="code"><pre><div class="line"><span class="keyword">bash </span>dcos_generate_config.<span class="keyword">sh </span>--uninstall</div></pre></td></tr></table></figure>
<h4 id="Authentication-opt-out"><a href="#Authentication-opt-out" class="headerlink" title="Authentication opt-out"></a>Authentication opt-out</h4><p><a href="https://dcos.io/docs/1.7/overview/security/#authentication-opt-out" target="_blank" rel="external">authentication-opt-out</a><br>If you are performing a custom advanced installation, you may opt out of Auth0-based authentication by adding the following directive to <code>genconf/config.yaml</code> (note that the quotes are currently required):</p>
<p><code>oauth_enabled: &#39;false&#39;</code></p>
<p>On AWS, when creating a stack, at the Specify Details step, you may choose to set the OAuthEnabled option to false to disable authentication for the DC/OS installation.</p>
<p>The same option is not currently available when installing DC/OS through the Azure Marketplace, but will be added in a future release along with other options to customize authentication.</p>
<h3 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h3><p><a href="http://elrepo.org/tiki/tiki-index.php" target="_blank" rel="external">ELrepo</a><br><a href="https://github.com/dcos/dcos" target="_blank" rel="external">dcos on github</a><br><a href="https://dcos.io/docs/1.7/administration/installing/custom/advanced/#configure-your-cluster" target="_blank" rel="external">configure-your-cluster</a></p>
<h3 id="All-right-it’s-show-time"><a href="#All-right-it’s-show-time" class="headerlink" title="All right, it’s show time"></a>All right, it’s show time</h3><p><img src="/images/2016/04/21/1.png" alt=""><br><img src="/images/2016/04/21/2.png" alt=""><br><img src="/images/2016/04/21/3.png" alt=""><br><img src="/images/2016/04/21/4.png" alt=""><br><img src="/images/2016/04/21/5.png" alt=""><br><img src="/images/2016/04/21/6.png" alt=""><br><img src="/images/2016/04/21/7.png" alt=""><br><img src="/images/2016/04/21/8.png" alt=""><br><img src="/images/2016/04/21/9.png" alt=""><br><img src="/images/2016/04/21/10.png" alt=""><br><img src="/images/2016/04/21/11.png" alt=""><br><img src="/images/2016/04/21/12.png" alt=""><br><img src="/images/2016/04/21/13.png" alt=""><br><img src="/images/2016/04/21/14.png" alt=""><br><img src="/images/2016/04/21/15.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.wuliwala.net/2016/04/21/dcos_installation/" data-id="cj6yrbcth000c7u5oku5tyxej" class="article-share-link">Share</a>
      
        <a href="http://blog.wuliwala.net/2016/04/21/dcos_installation/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dcos/">dcos</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mesos/">mesos</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/03/16/logstash-cpu-percent-100/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          logstash CPU high
        
      </div>
    </a>
  
  
    <a href="/2016/04/21/using_nxlog_to_send_windows_event_logs_to_logstash/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Using NxLog to send Windows Event Logs to Logstash</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/30/powerful_wrk/">Powerful wrk</a>
          </li>
        
          <li>
            <a href="/2017/03/16/logstash-cpu-percent-100/">logstash CPU high</a>
          </li>
        
          <li>
            <a href="/2016/04/21/dcos_installation/">DC/OS Deployment</a>
          </li>
        
          <li>
            <a href="/2016/04/21/using_nxlog_to_send_windows_event_logs_to_logstash/">Using NxLog to send Windows Event Logs to Logstash</a>
          </li>
        
          <li>
            <a href="/2016/04/12/upgrade_influxdb_from_v0.9_to_v0.10/">Upgrade influxdb from v0.9 to v0.12</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/app/" style="font-size: 10px;">app</a> <a href="/tags/benchmark/" style="font-size: 10px;">benchmark</a> <a href="/tags/dcos/" style="font-size: 10px;">dcos</a> <a href="/tags/dev/" style="font-size: 20px;">dev</a> <a href="/tags/devops/" style="font-size: 13.33px;">devops</a> <a href="/tags/dhcp/" style="font-size: 10px;">dhcp</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/elk/" style="font-size: 16.67px;">elk</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/graphing/" style="font-size: 10px;">graphing</a> <a href="/tags/influxdb/" style="font-size: 10px;">influxdb</a> <a href="/tags/ionic/" style="font-size: 10px;">ionic</a> <a href="/tags/ipmi/" style="font-size: 10px;">ipmi</a> <a href="/tags/logstash/" style="font-size: 10px;">logstash</a> <a href="/tags/mesos/" style="font-size: 10px;">mesos</a> <a href="/tags/monitoring/" style="font-size: 13.33px;">monitoring</a> <a href="/tags/nosql/" style="font-size: 10px;">nosql</a> <a href="/tags/nxlog/" style="font-size: 10px;">nxlog</a> <a href="/tags/pxe/" style="font-size: 10px;">pxe</a> <a href="/tags/search/" style="font-size: 10px;">search</a> <a href="/tags/sysops/" style="font-size: 13.33px;">sysops</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/virtualization/" style="font-size: 10px;">virtualization</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/wrk/" style="font-size: 10px;">wrk</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/app/">app</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/benchmark/">benchmark</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dcos/">dcos</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dev/">dev</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/">devops</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dhcp/">dhcp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elk/">elk</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/graphing/">graphing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/influxdb/">influxdb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ionic/">ionic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ipmi/">ipmi</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logstash/">logstash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mesos/">mesos</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/monitoring/">monitoring</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nosql/">nosql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nxlog/">nxlog</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pxe/">pxe</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/search/">search</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sysops/">sysops</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virtualization/">virtualization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wrk/">wrk</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 arkii<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="http://blog.wuliwala.net" class="mobile-nav-link">Home</a>
  
    <a href="http://blog.wuliwala.net/archives" class="mobile-nav-link">Archives</a>
  
    <a href="http://blog.wuliwala.net/about" class="mobile-nav-link">About</a>
  
    <a href="https://github.com/arkii" class="mobile-nav-link">GitHub</a>
  
    <a href="https://hub.docker.com/u/arkii" class="mobile-nav-link">DockerHub</a>
  
</nav>
    
<script>
  var disqus_shortname = 'blog-arkii';
  
  var disqus_url = 'http://blog.wuliwala.net/2016/04/21/dcos_installation/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->
<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>